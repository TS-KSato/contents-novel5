<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>é‹å‘½ã®éŠ€ç«œæš¦ï½œã‚¢ãƒ©ãƒ³ã®é£Ÿå“</title>
  <meta name="description" content="å®Ÿå‹™å®¶ã‚¢ãƒ©ãƒ³ã®è¦–ç‚¹ã§ã¾ã¨ã‚ãŸã€ã‚¨ãƒ†ãƒ«ãƒŠãƒªã‚¢ã®ç´ æœ´ãªæ—¥å¸¸é£Ÿã€‚å†ç¾ã—ã‚„ã™ã„åˆ†é‡ã¨æ‰‹é †ã§ã€‚">
  <style>
    html { font-size: 16px; }
    :root{
      --bg:#0b0d12; --ink:#ffffff; --muted:#aeb7d0; --line:#27304a; --card:#151826;
      --accent:#9fd3ff; --accent-2:#1a3358; --accent-2-b:#34507c;
      --radius:.875rem; --pad:1rem; --gap:.75rem; --tap:2.75rem;
    }
    *{ box-sizing:border-box }
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP",sans-serif;
      line-height:1.8; font-size:1rem; -webkit-text-size-adjust:100%;
      text-rendering: optimizeLegibility;
      padding-bottom:4.5rem; /* ä¸‹éƒ¨ãƒŠãƒ“åˆ†ã®ä½™ç™½ */
    }
    .wrap{ max-width:40rem; margin:0 auto; padding:1.0rem 1.0rem 0; }

    header{ text-align:center; padding:.5rem .25rem .75rem; }
    header h1{ margin:.25rem 0 .25rem; font-size:clamp(1.15rem,5vw,1.5rem); font-weight:700; }
    header .muted{ color:var(--muted); font-size:.875rem; margin:.25rem 0 0; }

    .card{ background:var(--card); border:1px solid var(--line); border-radius:var(--radius); padding:var(--pad); margin:.75rem 0; }
    .label{ font-size:.9375rem; color:#cfe1ff; margin-bottom:.5rem }

    .list{ display:grid; gap:.75rem; }
    .item{
      display:grid; grid-template-columns:auto 1fr auto; gap:.75rem; align-items:center;
      background:#11172a; border:1px solid var(--line); border-radius:.75rem; padding:.625rem .75rem;
      text-decoration:none; color:inherit;
    }
    .item:hover{ background:#16203a }
    .name{ font-size:1rem; font-weight:700; line-height:1.4; }
    .sub{ font-size:.8125rem; color:var(--muted); }
    .pill{ display:inline-flex; align-items:center; justify-content:center; color:#d7e6ff; background:#13203a; border:1px solid #2b3b61; border-radius:999px; padding:.25rem .5rem; font-size:.75rem; text-decoration:none; }

    .avatar{ width:2.75rem; height:2.75rem; border-radius:50%; border:1px solid var(--line); background:#10172a center/cover no-repeat; display:flex; align-items:center; justify-content:center; font-weight:700; color:#cfe1ff; flex-shrink:0; }
    .avatar.fallback{ background:#10172a; }

    /* ä¸Šéƒ¨ã®è£œåŠ©ãƒŠãƒ“ */
    .tabs{ display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin-top:.5rem; }
    .tabs a{ color:#d7e6ff; border:1px solid var(--line); background:#11172a; border-radius:999px; padding:.25rem .625rem; font-size:.8125rem; text-decoration:none; }

    /* ä¸‹éƒ¨å›ºå®šãƒŠãƒ“ */
    .bottom-nav{ position:fixed; left:0; right:0; bottom:0; z-index:50; background:rgba(10,14,22,.9); backdrop-filter:blur(8px); border-top:1px solid var(--line); }
    .bn-grid{ max-width:40rem; margin:0 auto; display:grid; grid-template-columns:repeat(3,1fr); }
    .bn-btn{ appearance:none; background:none; border:0; color:#cfe1ff; text-decoration:none; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:.375rem 0; min-height:3.25rem; font-size:.75rem; }
    .bn-icon{ width:20px; height:20px; margin-bottom:.125rem; border-radius:4px; border:1px solid var(--line); background:#16213c; display:flex; align-items:center; justify-content:center; font-size:.75rem; }
    .bn-accent{ color:#fff; }

    footer{ text-align:center; color:var(--muted); font-size:.75rem; margin:1rem 0 .75rem }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ã‚¢ãƒ©ãƒ³ã®é£Ÿå“</h1>
      <p class="muted">é“å…·ã¯æœ€å°é™ã€æ‰‹é †ã¯æ˜ç¢ºã«ã€‚å†ç¾ã—ã‚„ã™ã•é‡è¦–ã®å®¶åº­æ–™ç†ã€‚</p>
      <nav class="tabs" aria-label="é£Ÿå“å†…ãƒŠãƒ“">
        <a href="./food.html">ä»Šæ—¥ã®ä¸€å“</a>
        <a aria-current="page" href="./food_alan.html">ã‚¢ãƒ©ãƒ³</a>
        <a href="./food_drake.html">ãƒ‰ãƒ¬ã‚¤ã‚¯</a>
        <a href="./food_laila.html">ãƒ©ã‚¤ãƒ©</a>
        <a href="./food_nester.html">ãƒã‚¹ã‚¿ãƒ¼</a>
      </nav>
    </header>

    <section class="card" aria-label="ã‚¢ãƒ©ãƒ³ã®æ–™ç†ä¸€è¦§">
      <div class="label">ãƒ¬ã‚·ãƒ”ä¸€è¦§</div>
      <div id="list" class="list" role="list"></div>
    </section>

    <footer>Â© é‹å‘½ã®éŠ€ç«œæš¦</footer>
  </div>

  <!-- ä¸‹éƒ¨å›ºå®šãƒŠãƒ“ -->
  <nav class="bottom-nav" aria-label="ä¸»è¦ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³">
    <div class="bn-grid">
      <a class="bn-btn" href="./index.html" aria-label="ãƒ›ãƒ¼ãƒ ">
        <span class="bn-icon">ğŸ </span><span>ãƒ›ãƒ¼ãƒ </span>
      </a>
      <a class="bn-btn" href="./notice.html" aria-label="ãŠçŸ¥ã‚‰ã›">
        <span class="bn-icon">ğŸ“£</span><span>ãŠçŸ¥ã‚‰ã›</span>
      </a>
      <a class="bn-btn" href="./mypage.html" aria-label="ãƒã‚¤ãƒšãƒ¼ã‚¸">
        <span class="bn-icon">ğŸ‘¤</span><span>ãƒã‚¤ãƒšãƒ¼ã‚¸</span>
      </a>
    </div>
  </nav>

<script>
const JSON_PATH = "./recipe.json";

/* ---------- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---------- */
function esc(s){ return String(s||"").replace(/[&<>]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[m])); }
function clip(t, n){ if(!t) return ""; const s=String(t); return s.length>n ? s.slice(0,n-1)+"â€¦" : s; }

/* ---------- æç”» ---------- */
const listEl = document.getElementById("list");

function renderList(items){
  if(!items.length){
    listEl.innerHTML = '<div class="sub">ã‚¢ãƒ©ãƒ³ã®ãƒ¬ã‚·ãƒ”ã¯æº–å‚™ä¸­ã§ã™ã€‚recipe.json ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</div>';
    return;
  }
  const html = items.map(r => {
    const initials = (r.character||"").slice(0,2) || "é£Ÿ";
    const avatar = r.avatar
      ? `<div class="avatar" style="background-image:url('${esc(r.avatar)}');" aria-hidden="true"></div>`
      : `<div class="avatar fallback" aria-hidden="true">${esc(initials)}</div>`;

    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: id ã‚’ã‚¯ã‚¨ãƒªã«ä»˜ä¸ï¼ˆãªã‘ã‚Œã° title ãƒãƒƒã‚·ãƒ¥ã‚’ä»£æ›¿ï¼‰
    const id = r.id != null ? String(r.id) : String(Math.abs(hashStr(r.title||"")));

    return `
      <a class="item" role="listitem" href="./recipe.html?id=${encodeURIComponent(id)}" aria-label="${esc(r.title)}ã®è©³ç´°ã¸">
        ${avatar}
        <div>
          <div class="name">${esc(r.title)}</div>
          <div class="sub">${esc(clip(r.intro || r.comment || "", 46))}</div>
        </div>
        <span class="pill">è©³ã—ã â†’</span>
      </a>
    `;
  }).join("");
  listEl.innerHTML = html;
}

/* ---------- ãƒãƒƒã‚·ãƒ¥é–¢æ•°ï¼ˆid ä»£æ›¿ç”¨ï¼‰ ---------- */
function hashStr(s){ let h=2166136261>>>0; for(let i=0;i<s.length;i++){ h^=s.charCodeAt(i); h=Math.imul(h,16777619);} return h>>>0; }

/* ---------- èµ·å‹• ---------- */
(async function init(){
  try{
    const res = await fetch(JSON_PATH, {cache:"no-cache"});
    if(!res.ok) throw new Error("fetch failed");
    const data = await res.json();
    const recipes = Array.isArray(data) ? data : (Array.isArray(data.items) ? data.items : []);

    // ã‚¢ãƒ©ãƒ³ã®ã¿æŠ½å‡º â†’ ã‚¿ã‚¤ãƒˆãƒ«ã§å®‰å®šã‚½ãƒ¼ãƒˆ
    const alan = recipes.filter(r => (r.character||"") === "ã‚¢ãƒ©ãƒ³").sort((a,b)=>{
      const ta=(a.title||"").localeCompare(b.title||"", 'ja');
      return ta;
    });

    renderList(alan);
  }catch(e){
    console.warn("recipe.jsonèª­ã¿è¾¼ã¿å¤±æ•—:", e);
    listEl.innerHTML = '<div class="sub">ãƒ¬ã‚·ãƒ”ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚recipe.json ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</div>';
  }
})();
</script>
</body>
</html>
