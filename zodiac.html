<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>運命の銀竜暦｜星座別診断表</title>
  <meta name="description" content="12星座の性質をエテルナリア世界観で読み解く固定辞典。導き柱／重んずる界／役割相／親和元素／種族縁と短い伝承（ロア）を収録。">
  <style>
    /* ベース：スマホ縦向け、rem中心、可変見出し */
    html { font-size: 16px; }
    :root{
      --bg:#0b0d12; --ink:#ffffff; --muted:#aeb7d0; --line:#27304a; --card:#151826;
      --accent:#9fd3ff; --accent-2:#1a3358; --accent-2-b:#34507c;
      --radius:.875rem; --pad:1rem; --gap:.75rem; --tap:2.75rem;
    }
    *{ box-sizing:border-box }
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP",sans-serif;
      line-height:1.7; font-size:1rem; -webkit-text-size-adjust:100%;
    }
    .wrap{ max-width:40rem; margin:0 auto; padding:1.25rem }

    header{ text-align:center; padding:1rem .5rem; }
    header h1{ margin:.25rem 0 .5rem; font-size:clamp(1.25rem,5.5vw,1.5rem); }
    .muted{ color:var(--muted); font-size:.875rem }

    .nav{ display:flex; gap:.75rem; flex-wrap:wrap; justify-content:center; margin:.5rem 0 1rem }
    .pill{
      display:inline-flex; align-items:center; justify-content:center;
      color:var(--accent); text-decoration:none; background:#11172a; border:1px solid var(--line);
      padding:.375rem .625rem; border-radius:999px; font-size:.8125rem; min-height:var(--tap);
    }
    .pill:hover{ background:#18213a }
    .pill.accent{ background:var(--accent-2); border-color:var(--accent-2-b); color:#fff }
    .pill.small{ min-height:2rem; font-size:.75rem }

    details.guide{ margin:1rem 0 }
    details.guide summary{ cursor:pointer; font-weight:700 }
    details.guide .guide-body{ padding:.5rem 0 0; color:#d9e2ff; font-size:.9375rem }

    .controls{
      display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin:.5rem 0 1rem;
    }
    select, button{
      font-size:1rem; min-height:var(--tap); border-radius:.625rem; border:1px solid var(--line);
      background:#1a2034; color:#fff; padding:.5rem .75rem;
    }
    button{ cursor:pointer }
    button:focus-visible, select:focus-visible{ outline:2px solid var(--accent); outline-offset:2px }

    .legend{
      display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin:.25rem 0 1rem;
    }
    .badge{
      display:inline-flex; align-items:center; gap:.25rem;
      padding:.125rem .5rem; border-radius:999px; border:1px solid var(--line);
      font-size:.75rem; color:#cfe1ff; background:#11172a;
    }

    .grid{ display:grid; gap:.75rem; grid-template-columns:repeat(2,minmax(0,1fr)) }
    @media(min-width:30rem){ .grid{ grid-template-columns:repeat(3,minmax(0,1fr)) } }

    .card{
      background:var(--card); border:1px solid var(--line); border-radius:var(--radius); padding:var(--pad);
    }
    .z-head{ display:flex; align-items:center; gap:.5rem; margin-bottom:.25rem }
    .z-rune{ font-size:1.25rem } /* 装飾記号 */
    .z-name{ font-weight:700; font-size:1.05rem } /* ★星座名のみ表示 */
    .pairs{ display:flex; gap:.375rem; flex-wrap:wrap; margin:.25rem 0 .25rem }
    .lore{ margin-top:.25rem; color:#e0e7ff; font-size:.9375rem }
    .more{ margin-top:.5rem; font-size:.8125rem; color:var(--muted) }

    .copy-link{ margin-left:auto; font-size:.75rem; color:#9fd3ff; cursor:pointer }

    footer{ text-align:center; color:var(--muted); font-size:.75rem; margin:1rem 0 .5rem }
    .footlinks{ display:flex; gap:.75rem; flex-wrap:wrap; justify-content:center; margin-bottom:.5rem }

    @media print{
      .nav, .controls, .legend, .footlinks, .copy-link { display:none !important }
      body{ background:#fff; color:#000 }
      .card{ border-color:#999 }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header id="top">
      <h1>星座別診断表</h1>
      <p class="muted">
        12星座の名はそのままに、<br>
        性質の読み解きはエテルナリアの語で記す固定辞典です。<br>
        各星座は「導き柱／重んずる界／役割相／親和元素／種族縁」と短い伝承（ロア）で表します。
      </p>
      <nav class="nav">
        <a href="./index.html" class="pill">← 占いトップ</a>
        <a href="./list.html" class="pill">おまけページ</a>
        <a href="./novel.html" class="pill">小説ページ</a>
      </nav>
    </header>

    <!-- 世界観用語ガイド（簡潔・普遍） -->
    <details class="guide" open>
      <summary>用語ガイド</summary>
      <div class="guide-body">
        <p><strong>導き柱</strong>：行いを選ぶ中核。<em>剛意</em>（自力で切り拓く）／<em>律序</em>（秩序で積み上げる）／<em>情脈</em>（心の波に従う）／<em>叡照</em>（理解と洞察で導く）。</p>
        <p><strong>重んずる界</strong>：価値を見出す領域。<em>社界</em>（人と働き）／<em>森界</em>（自然と循環）／<em>理界</em>（理と術の探究）／<em>霊界</em>（祈りと超越）。</p>
        <p><strong>役割相</strong>：場で現れやすい役回り。<em>先陣</em>（潮を作る）／<em>守護</em>（流れを保つ）。</p>
        <p><strong>親和元素</strong>：性質が調和しやすい基調（炎／土／風／水）。</p>
        <p><strong>種族縁</strong>：<em>銀竜・人間・妖精</em>のいずれに近い響きを持つか。</p>
      </div>
    </details>

    <!-- フィルタ（固有語で統一） -->
    <div class="controls" aria-label="絞り込み">
      <select id="fPillar" aria-label="導き柱で絞り込み">
        <option value="">導き柱：すべて</option>
        <option>剛意</option><option>律序</option><option>情脈</option><option>叡照</option>
      </select>
      <select id="fRealm" aria-label="重んずる界で絞り込み">
        <option value="">重んずる界：すべて</option>
        <option>社界</option><option>森界</option><option>理界</option><option>霊界</option>
      </select>
      <select id="fRole" aria-label="役割相で絞り込み">
        <option value="">役割相：すべて</option>
        <option>先陣</option><option>守護</option>
      </select>
      <select id="fKin" aria-label="種族縁で絞り込み">
        <option value="">種族縁：すべて</option>
        <option>銀竜</option><option>人間</option><option>妖精</option>
      </select>
      <button id="reset">リセット</button>
    </div>

    <!-- 凡例 -->
    <div class="legend" aria-hidden="true">
      <span class="badge">導き柱</span>
      <span class="badge">重んずる界</span>
      <span class="badge">役割相</span>
      <span class="badge">親和元素</span>
      <span class="badge">種族縁</span>
    </div>

    <!-- 一覧 -->
    <div id="grid" class="grid" aria-live="polite"></div>

    <nav class="nav">
      <a href="./index.html" class="pill">← 占いトップ</a>
      <a href="#top" class="pill small">ページ先頭へ</a>
    </nav>
    <footer>
      <div class="footlinks"></div>
      © 運命の銀竜暦
    </footer>
  </div>

  <script>
    // ===== 永年固定の辞典データ（星座名のみ表示、内容は世界観語彙） =====
    const ZODIACS = [
      { id:"aries",   記号:"⟡", 星座:"牡羊座", 導き柱:"剛意", 重んずる界:"社界", 役割相:"先陣", 親和元素:"炎", 種族縁:"銀竜",
        ロア:"額角の尖光のごとく始まりを告げる。ためらいを裂き、停滞を切り開く。" },
      { id:"taurus",  記号:"⟐", 星座:"牡牛座", 導き柱:"律序", 重んずる界:"森界", 役割相:"守護", 親和元素:"土", 種族縁:"人間",
        ロア:"踏み固めた轍は道となる。蓄えを耕し、実りの季を揺るがせない。" },
      { id:"gemini",  記号:"⋇", 星座:"双子座", 導き柱:"叡照", 重んずる界:"社界", 役割相:"先陣", 親和元素:"風", 種族縁:"妖精",
        ロア:"二つの声は風に乗る。離れても呼応し、遠きをひとつに結ぶ。" },
      { id:"cancer",  記号:"☽", 星座:"蟹座",   導き柱:"情脈", 重んずる界:"霊界", 役割相:"守護", 親和元素:"水", 種族縁:"妖精",
        ロア:"潮が抱く揺籃。傷を覆い、静かな祈りで夜を渡らせる。" },
      { id:"leo",     記号:"✹", 星座:"獅子座", 導き柱:"剛意", 重んずる界:"社界", 役割相:"先陣", 親和元素:"炎", 種族縁:"銀竜",
        ロア:"焔は冠、誇りは旗。中心に立ち、光を分かつ。" },
      { id:"virgo",   記号:"✶", 星座:"乙女座", 導き柱:"律序", 重んずる界:"理界", 役割相:"守護", 親和元素:"土", 種族縁:"人間",
        ロア:"穂は数えられ、頁は整う。細部の調律が全体を静かに正す。" },
      { id:"libra",   記号:"⚖", 星座:"天秤座", 導き柱:"叡照", 重んずる界:"社界", 役割相:"守護", 親和元素:"風", 種族縁:"人間",
        ロア:"片羽が沈めば、もう片羽が上がる。均衡の中点に留まる術を知る。" },
      { id:"scorpio", 記号:"⟀", 星座:"蠍座",   導き柱:"情脈", 重んずる界:"霊界", 役割相:"先陣", 親和元素:"水", 種族縁:"銀竜",
        ロア:"深針は誓いを貫く。静かな熱が運命の布を結び替える。" },
      { id:"sagittarius", 記号:"➹", 星座:"射手座", 導き柱:"叡照", 重んずる界:"森界", 役割相:"先陣", 親和元素:"炎", 種族縁:"人間",
        ロア:"遠矢は地平を越える。答えは遠く、歩は軽い。" },
      { id:"capricorn", 記号:"⟑", 星座:"山羊座", 導き柱:"律序", 重んずる界:"社界", 役割相:"先陣", 親和元素:"土", 種族縁:"人間",
        ロア:"古塔の段を一歩ずつ。責務を背に、頂へ至る蹄音は確か。" },
      { id:"aquarius", 記号:"⌇", 星座:"水瓶座", 導き柱:"叡照", 重んずる界:"理界", 役割相:"守護", 親和元素:"風", 種族縁:"妖精",
        ロア:"星水を分かち合う器。常の形を替え、新しき流れを注ぐ。" },
      { id:"pisces",   記号:"Ͽ", 星座:"魚座",   導き柱:"情脈", 重んずる界:"森界", 役割相:"守護", 親和元素:"水", 種族縁:"妖精",
        ロア:"夢と現の境を泳ぐ歌い手。やわらかな共鳴が固きをほどく。" }
    ];

    // ===== DOM参照 =====
    const grid = document.getElementById('grid');
    const fP = document.getElementById('fPillar');
    const fR = document.getElementById('fRealm');
    const fO = document.getElementById('fRole');
    const fK = document.getElementById('fKin');
    const btnReset = document.getElementById('reset');

    function cardHTML(z){
      const href = `#${z.id}`;
      return `
        <article id="${z.id}" class="card" tabindex="0" aria-label="${z.星座}の記述">
          <div class="z-head">
            <div class="z-rune" aria-hidden="true">${z.記号}</div>
            <div class="z-name">${z.星座}</div>
            <span class="badge" title="親和元素">${z.親和元素}</span>
            <button class="copy-link" onclick="copyPermalink('${location.origin}${location.pathname}${href}')" aria-label="${z.星座}のリンクをコピー">リンク</button>
          </div>
          <div class="pairs">
            <span class="badge" title="導き柱">導き柱：${z.導き柱}</span>
            <span class="badge" title="重んずる界">重んずる界：${z.重んずる界}</span>
            <span class="badge" title="役割相">役割相：${z.役割相}</span>
            <span class="badge" title="種族縁">種族縁：${z.種族縁}</span>
          </div>
          <div class="lore">${z.ロア}</div>
          <div class="more muted">※ 固定辞典の記述であり、日替わり占いの結果とは独立しています。</div>
        </article>
      `;
    }

    function matchFilter(z){
      if (fP.value && z.導き柱 !== fP.value) return false;
      if (fR.value && z.重んずる界 !== fR.value) return false;
      if (fO.value && z.役割相   !== fO.value) return false;
      if (fK.value && z.種族縁   !== fK.value) return false;
      return true;
    }

    function render(){
      const items = ZODIACS.filter(matchFilter).map(cardHTML).join('');
      grid.innerHTML = items || `<div class="muted">該当する星座がありません。</div>`;
    }

    function copyPermalink(url){
      navigator.clipboard?.writeText(url).then(()=>{
        alert("パーマリンクをコピーしました。");
      }).catch(()=>{
        prompt("以下のURLをコピーしてください", url);
      });
    }

    [fP,fR,fO,fK].forEach(el=> el.addEventListener('change', render));
    btnReset.addEventListener('click', ()=>{ fP.value=""; fR.value=""; fO.value=""; fK.value=""; render(); });

    function focusAnchor(){
      if (location.hash){
        const el = document.getElementById(location.hash.slice(1));
        if (el){ el.focus({preventScroll:false}); }
      }
    }

    render();
    window.addEventListener('hashchange', focusAnchor);
    focusAnchor();
  </script>
</body>
</html>
