<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é‹å‘½ã®éŠ€ç«œæš¦ï½œãƒã‚¤ãƒšãƒ¼ã‚¸ï¼ˆæœ€å°ãƒ‡ãƒ¢ï¼‰</title>
  <style>
    :root{
      --bg:#0b0f14;--panel:#121821;--ink:#e9f1ff;--muted:#97a7c2;--accent:#8dd0ff;--ring:0 0 0 2px rgba(141,208,255,.25),0 8px 24px rgba(0,0,0,.25);--r:16px
    }
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif}
    .wrap{max-width:720px;margin:auto;padding:16px}
    h1{font-size:1.2rem;margin:10px 0 16px}
    .card{background:var(--panel);border:1px solid rgba(141,208,255,.18);border-radius:var(--r);box-shadow:var(--ring);margin-bottom:12px}
    .card-h{padding:12px 14px;border-bottom:1px dashed rgba(141,208,255,.2);font-weight:700}
    .card-c{padding:12px 14px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:8px 10px;border-radius:999px;background:rgba(141,208,255,.12);border:1px solid rgba(141,208,255,.28);font-weight:700}
    .btn{appearance:none;border:none;background:rgba(141,208,255,.18);border:1px solid rgba(141,208,255,.35);color:var(--ink);padding:10px 12px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .muted{color:var(--muted)}
    .list{display:grid;gap:8px}
    .item{display:flex;justify-content:space-between;gap:8px;padding:10px;border-radius:12px;background:rgba(141,208,255,.07);border:1px solid rgba(141,208,255,.14)}
    label{display:block;margin:.4rem 0 .15rem;font-size:.9rem;color:var(--muted)}
    input,select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(141,208,255,.25);background:#0f141c;color:var(--ink)}
    .grid{display:grid;gap:10px;grid-template-columns:1fr 1fr}
    @media(max-width:480px){.grid{grid-template-columns:1fr}}
    .links{display:grid;gap:8px}
    a.link{display:block;padding:12px;border-radius:12px;background:rgba(141,208,255,.07);border:1px solid rgba(141,208,255,.14);text-decoration:none;color:var(--ink)}
  </style>
</head>
<body>
  <main class="wrap" id="app" role="main">
    <h1>ãƒã‚¤ãƒšãƒ¼ã‚¸</h1>

    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <section class="card">
      <div class="card-h">ä¼šå“¡æƒ…å ±</div>
      <div class="card-c">
        <div class="row" aria-live="polite">
          <div class="pill" id="memberPill">ğŸ”“ éä¼šå“¡</div>
          <div class="pill">ãƒã‚¤ãƒ³ãƒˆï¼š<span id="points">0</span> pt</div>
          <button class="btn" id="btnCharge">ãƒãƒ£ãƒ¼ã‚¸ï¼ˆãƒ‡ãƒ¢ï¼‰</button>
          <button class="btn" id="btnToggle">ä¼šå“¡ã«ã™ã‚‹/ã‚„ã‚ã‚‹ï¼ˆãƒ‡ãƒ¢ï¼‰</button>
        </div>
      </div>
    </section>

    <!-- å ã„å±¥æ­´ -->
    <section class="card">
      <div class="card-h">å ã„å±¥æ­´</div>
      <div class="card-c">
        <div class="list" id="history"></div>
        <div class="muted" id="histEmpty" style="display:none">å±¥æ­´ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</div>
        <div class="row" style="margin-top:8px">
          <button class="btn" id="btnMock">å±¥æ­´ã‚’1ä»¶è¿½åŠ ï¼ˆãƒ‡ãƒ¢ï¼‰</button>
          <button class="btn" id="btnClear">å±¥æ­´ã‚’æ¶ˆå»ï¼ˆãƒ‡ãƒ¢ï¼‰</button>
        </div>
      </div>
    </section>

    <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ï¼ˆæœˆæ—¥ï¼‹æ€§åˆ¥ï¼‰ -->
    <section class="card">
      <div class="card-h">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</div>
      <div class="card-c">
        <div class="grid">
          <div>
            <label for="month">èª•ç”Ÿæœˆ</label>
            <select id="month" aria-label="èª•ç”Ÿæœˆ"></select>
          </div>
          <div>
            <label for="day">èª•ç”Ÿæ—¥</label>
            <select id="day" aria-label="èª•ç”Ÿæ—¥"></select>
          </div>
          <div>
            <label for="gender">æ€§åˆ¥</label>
            <select id="gender" aria-label="æ€§åˆ¥">
              <option value="">æœªè¨­å®š</option>
              <option value="male">ç”·æ€§</option>
              <option value="female">å¥³æ€§</option>
              <option value="other">ãã®ä»–</option>
              <option value="secret">å›ç­”ã—ãªã„</option>
            </select>
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn" id="btnSave">ä¿å­˜</button>
          <span class="muted" id="saveMsg"></span>
        </div>
      </div>
    </section>

    <!-- å„ç¨®ãƒªãƒ³ã‚¯ -->
    <section class="card">
      <div class="card-h">ãƒªãƒ³ã‚¯</div>
      <div class="card-c">
        <div class="links">
          <a class="link" href="./notice.html">ãŠçŸ¥ã‚‰ã›</a>
          <a class="link" href="./contact.html">ãŠå•ã„åˆã‚ã›</a>
          <a class="link" href="./unsubscribe.html" id="linkUnsub" style="display:none">é€€ä¼šã™ã‚‹ï¼ˆä¼šå“¡ã®ã¿ï¼‰</a>
        </div>
      </div>
    </section>
  </main>

  <script>
    // ====== æœ€å°ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆãƒ‡ãƒ¢ï¼‰ ======
    const S = {get:(k,d)=>{try{return JSON.parse(localStorage.getItem(k))??d}catch{return d}}, set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)), del:(k)=>localStorage.removeItem(k)};

    function seed(){
      if(S.get('gl_member')==null) S.set('gl_member', false);
      if(S.get('gl_points')==null) S.set('gl_points', 0);
      if(!S.get('gl_history')) S.set('gl_history', []);
      if(!S.get('gl_profile')) S.set('gl_profile', {month:"", day:"", gender:""});
    }

    // ====== æç”» ======
    function renderStatus(){
      const m = !!S.get('gl_member');
      const pill = document.getElementById('memberPill');
      pill.textContent = m ? 'ğŸ›¡ï¸ ä¼šå“¡' : 'ğŸ”“ éä¼šå“¡';
      document.getElementById('points').textContent = S.get('gl_points',0);
      document.getElementById('linkUnsub').style.display = m ? '' : 'none';
    }

    function renderHistory(){
      const list = S.get('gl_history', []);
      const box = document.getElementById('history'); box.innerHTML='';
      document.getElementById('histEmpty').style.display = list.length? 'none':'block';
      list.slice().reverse().forEach((h)=>{
        const el = document.createElement('div'); el.className='item';
        el.innerHTML = `<span>${h.date}</span><span class="muted">${h.title||'ç·åˆå ã„'}</span>`;
        box.appendChild(el);
      });
    }

    function renderProfile(){
      const mSel = document.getElementById('month');
      const dSel = document.getElementById('day');
      mSel.innerHTML = '<option value="">--</option>' + Array.from({length:12},(_,i)=>`<option value="${i+1}">${i+1}</option>`).join('');
      dSel.innerHTML = '<option value="">--</option>' + Array.from({length:31},(_,i)=>`<option value="${i+1}">${i+1}</option>`).join('');
      const p = S.get('gl_profile',{month:"",day:"",gender:""});
      if(p.month) mSel.value = p.month;
      if(p.day) dSel.value = p.day;
      document.getElementById('gender').value = p.gender||'';
    }

    // ====== ã‚¤ãƒ™ãƒ³ãƒˆ ======
    function wire(){
      document.getElementById('btnCharge').addEventListener('click',()=>{
        const v = parseInt(prompt('ãƒãƒ£ãƒ¼ã‚¸ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆï¼ˆä¾‹ï¼š100ï¼‰','100')||'0',10);
        if(v>0){ S.set('gl_points', S.get('gl_points',0)+v); renderStatus(); }
      });
      document.getElementById('btnToggle').addEventListener('click',()=>{
        const cur = !!S.get('gl_member'); S.set('gl_member', !cur); renderStatus();
      });
      document.getElementById('btnMock').addEventListener('click',()=>{
        const list = S.get('gl_history', []);
        const today = new Date().toISOString().slice(0,10);
        list.push({date:today, title:'ç·åˆå ã„'}); S.set('gl_history', list); renderHistory();
      });
      document.getElementById('btnClear').addEventListener('click',()=>{ if(confirm('å±¥æ­´ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')){ S.set('gl_history', []); renderHistory(); }});

      document.getElementById('btnSave').addEventListener('click',()=>{
        const month = document.getElementById('month').value;
        const day = document.getElementById('day').value;
        const gender = document.getElementById('gender').value;
        S.set('gl_profile',{month,day,gender});
        const msg = document.getElementById('saveMsg'); msg.textContent='ä¿å­˜ã—ã¾ã—ãŸ'; setTimeout(()=>msg.textContent='',1500);
      });
    }

    function start(){ seed(); renderStatus(); renderHistory(); renderProfile(); wire(); }
    start();
  </script>
</body>
</html>
