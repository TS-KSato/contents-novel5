// world-timeline.js — インライン年表を外部化
const data = [
  { id:"era-prehistory", title:"先史時代 — 石器と部族の時代", when:"AK以前（年代不詳）", events:[
    ["遠古","狩猟採集の広がり","複数の人系・長命種が各地で分散居住。石器と骨角器による生活技術が定着した。"],
    ["遠古","部族連合の発生","季節移動と婚姻同盟で緩やかな連合が成立。争いは儀式化され、血讐の連鎖を抑える仕組みが芽生える。"],
    ["遠古","竜との関係の二分","地域により竜は「守護神」として祀られ、別地域では「害」として追い払われた記録が口承に残る。"],
  ]},
  { id:"era-sedentarization", title:"集住期 — 開墾と村落の形成", when:"AK前数千年〜AK前数百年", events:[
    ["AK前2000","牧畜・焼畑の開始","山麓と河谷で定住化が進み、穀と根菜の生産が安定。祭場と共同倉が村の中核となる。"],
    ["AK前1500","市日の誕生","街道沿いに定期市が立ち、部族間の物々交換が制度化。簡易な度量衡の印が使われ始める。"],
    ["AK前1200","鎖地（閉鎖地域）の成立","森エルフや島嶼系部族が外来者を禁じる慣行を制定。独自の婚姻規則と言語が強化された。"],
  ]},
  { id:"era-currency", title:"商業化期 — 貨幣と都市国家", when:"AK前数百年〜AK0前後", events:[
    ["AK前300","通貨の概念の誕生","高純度金属片に印章を刻んだ「貝替貨（がいがえか）」が市で流通。後の硬貨制の原型となる。"],
    ["AK前200","ギルドの萌芽","職能別の同業集団が自治規約を持ち、信用と計量を保証。商館が宿駅に併設された。"],
    ["AK前50","都市国家の台頭","城壁と広場を中心に共和国風の統治が成立。周辺農村と相互依存が強まる。"],
  ]},
  { id:"era-silver", title:"銀竜の残光期", when:"AK0–120", events:[
    ["AK50","聖域の成立","古竜の大地帰還後、泉や禁足林が各地に定着。巡礼と保護の慣行が生まれる。"],
    ["AK80","儀式魔法の普及","人の魔法は多人数の祈りで小成果を得る段階。術士団と評議会が安全規範を整備。"],
    ["AK100","市邦と小王の並立","都市共和国・封君領・森の自治圏が隣接。対竜観は地域差が大きく、信仰と警戒が共存した。"],
  ]},
  { id:"era-empire", title:"古代魔法文明 — 朝露の帝国", when:"AK300–500", events:[
    ["AK320","七大魔法評議会の成立","合議制による広域統治。多種協働が制度化され、学寮・工房・軍務が分掌された。"],
    ["AK350","硬貨制と税制の整備","銀貨・銅貨が標準化。関所・港で関税が徴収され、信用状が遠隔取引を支えた。"],
    ["AK400","魂の結晶の実用化","魔力の貯蔵・変換装置が民生に普及。照明・運搬・医療が飛躍し、都市生活が安定。"],
    ["AK420","〈門〉基礎理論の確立","アストラルシズム峡谷で次元研究が進展。学術都市が栄え、国際的学寮同盟が結成された。"],
    ["AK450","合同祭祀「光の祭り」","エルフの記憶歌と人の文字芸術が融合。帝国公式行事となり文化統合の象徴となる。"],
  ]},
  { id:"era-decline", title:"帝国の翳り", when:"AK450–500", events:[
    ["AK460","資源枯渇と価格高騰","魔法資源の過採取で物価が乱高下。周縁部に密輸と私掘りが横行し、治安が悪化。"],
    ["AK472","大噴火「黒い夏」","スカイアンビル山脈が噴火し寒冷化。飢饉と疫病が続き、人口が大きく減少した。"],
    ["AK480","次元不安定現象の頻発","〈門〉実験域で異常が増加。研究は制限され、地方勢力が自衛名目で軍備を拡張。"],
  ]},
  { id:"era-division", title:"分断と対立", when:"AK500–750", events:[
    ["AK520","登録法と居住区制","血統・種別による登録が義務化。混住地区が縮小し、職域や通行に制限がかかる。"],
    ["AK560","人類王権の分裂戦争","王位継承を巡る同族内戦が長期化。都市同盟が介入し、国境線が細かく引き直される。"],
    ["AK610","森エルフの鎖国令","外来者の立入を禁じる布告。交易は指定門前での置き渡しに限定され、文化の独自化が進む。"],
    ["AK640","ドワーフ諸鉱山の分派抗争","採掘権と技術秘伝を巡る内紛。一部都市は中立化し、海上中立商人が鉱産物流通を掌握。"],
    ["AK700","竜観の断層","一部地域で竜像を破却する運動が発生。他地域では守護信仰が強まり、宗教的緊張が高まる。"],
  ]},
  { id:"era-tension", title:"緊張の積層", when:"AK850–950", events:[
    ["AK860","大疫病「灰の咳」","都市部で流行し、検問と隔離が常態化。記名通行が市民生活に深く入り込む。"],
    ["AK880","地下自治区の形成","迫害を受けた集団が地下・峡谷・離島へ移住し自治。秘密言語と歌が連帯の印となる。"],
    ["AK940","非公式停戦の点在","前線は冷え、影の合意が局地的に成立。公的条約は形骸化したまま経済だけが細く続く。"],
  ]},
];

const list = document.getElementById('timeline');
list.innerHTML = data.map((era, i) => `
<li class="tli" id="${era.id}">
  <div class="dot" aria-hidden="true"></div>
  <article class="card" aria-labelledby="${era.id}-title">
    <div class="era">
      <h2 id="${era.id}-title">${era.title}</h2>
      <span class="when">${era.when}</span>
    </div>
    <ul class="events">
      ${era.events.map(ev=>`
      <li>
        <time>${ev[0]}</time>
        <div><div class="title">${ev[1]}</div><div class="desc">${ev[2]}</div></div>
      </li>`).join('')}
    </ul>
  </article>
</li>`).join('');

const back = document.getElementById('backTop');
function onScroll(){ if(window.scrollY>320){ back.classList.add('showTop'); } else { back.classList.remove('showTop'); } }
window.addEventListener('scroll', onScroll, {passive:true}); onScroll();
